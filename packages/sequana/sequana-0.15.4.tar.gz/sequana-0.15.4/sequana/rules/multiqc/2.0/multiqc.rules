#
#  This file is part of Sequana software
#
#  Copyright (c) 2016-2021 - Sequana Dev Team (https://sequana.readthedocs.io)
#
#  Distributed under the terms of the 3-clause BSD license.
#  The full license is in the LICENSE file, distributed with this software.
#
#  Website:       https://github.com/sequana/sequana
#  Documentation: http://sequana.readthedocs.io
#  Contributors:  https://github.com/sequana/sequana/graphs/contributors
##############################################################################


rule multiqc:
    """This rule launch multiqc;

    Input:

    - The variable **sequana_multiqc_input** must be define and must be a list of expected files

    Output:

    - "multiqc/multiqc_report.html" file is creaetd

    Parameters:

    The config file must contain the following field:

    - input_directory: the input directory expected by multiqc (defaults to .)
    - options: list of valid multiqc options (default to nothing)
    - config_file: a multiqc config file (default None)
    - modules:  a list of specific modules (default includes all)

    """
    input: sequana_multiqc_input
    output: "multiqc/multiqc_report.html"
    params:
        input_directory   = globals().get(config['multiqc']["input_directory"],  "."),
        options           = globals().get(config['multiqc']["options"],  ""),
        config_file       = globals().get(config['multiqc']["config_file"],  ""),
        modules           = globals().get(config['multiqc']["modules"],  "")
    log:
        "multiqc/multiqc.log"
    wrapper:
        "main/wrappers/multiqc"

